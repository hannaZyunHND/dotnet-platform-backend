R.Menu={Init:function(){R.Menu.culture=R.Culture(),R.Menu.FirstLoadLocation(),R.Menu.RegisterEvent(),R.Menu.current_location=R.CurrentLocationId(),R.Menu.GetDeptByLocationId(R.CurrentLocationId())},RegisterEvent:function(){$(".department-location").off("change").on("change",function(){var t=$(this).val();R.Menu.GetDeptByLocationId(t)}),$("._choosen").off("change").on("change",function(){var t=$("input[name='department']:checked").parent("label").text();$("#dropdownMenu1-1").html("").html(t)}),$(".dropdown-cart-trigger").off("click").on("click",function(){R.Menu.LoadDropdownCart()}),$(".dropdown-cart-trigger-mobile").off("click").on("click",function(){R.Menu.LoadDropdownCartMoblie()}),$(".small-cart-plus").off("click").on("click",function(){var t=$(this).closest(".item-cart").data("id"),o=parseInt($(this).closest(".item-cart").find(".small-cart-quantity").text());$(this).closest(".item-cart").find(".small-cart-quantity").text(o+1);var n=JSON.parse(localStorage.getItem("arrProduct"));n.find(function(n){n.product_id==t&&(n.quantity=parseInt(o)+1)}),localStorage.setItem("arrProduct",JSON.stringify(n)),R.LoadCart(),R.Menu.DropdownOrderDetailInLocalStorage()}),$(document).mouseup(function(t){var o=$(".dropdown-cart");o.is(t.target)||0!==o.has(t.target).length||o.hide()}),$(".small-cart-minus").off("click").on("click",function(){var t=$(this).closest(".item-cart").data("id"),o=parseInt($(this).closest(".item-cart").find(".small-cart-quantity").text());$(this).closest(".item-cart").find(".small-cart-quantity").text(o-1);var n=JSON.parse(localStorage.getItem("arrProduct"));n.find(function(n){n.product_id==t&&(n.quantity=parseInt(o)-1)}),localStorage.setItem("arrProduct",JSON.stringify(n)),R.LoadCart(),R.Menu.DropdownOrderDetailInLocalStorage()}),$(".last-seen-link").off("click").on("click",function(){R.Menu.LoadLastSeenProduct()}),$(".select-language").off("click").on("click",function(){var t=$(this).data("lang");R.Menu.SelectLanguage(t)}),$("#modal-lien-he").off("submit").on("submit",function(){var t=$("#txt-name-bh").val(),o=$("#txt-phone-bh").val(),n=$("#txt-yc-bh").val(),a="Địa điểm: "+$("#dropdownMenu1-1").html();a+=$("#txt-nd-bh").val();$("#dropdownMenu1-1").html();var e={Name:t,Phone:o,Address:"",Title:n,Content:a,Type:1,Source:"web"};return R.Menu.CreateServicesTicket(e),!1}),$(".small-cart-delte").off("click").on("click",function(){var t=$(this).closest(".item-cart").data("id");JSON.parse(localStorage.getItem("arrProduct")).find(function(o){o.product_id==t&&R.RemoveCartItem(t)}),$(this).closest(".item-cart").remove(),R.LoadCart(),R.Menu.DropdownOrderDetailInLocalStorage()})},GetDeptByLocationId:function(t){var o="/Store/ListDeptByLocId?id="+t;$.get(o,function(o){$(".department-location").val(t),$("#your-custom-id").html("").html(o),R.Menu.RegisterEvent()})},CreateServicesTicket:function(t){var o=R.Menu.culture+"/Extra/CreateServiceTicket";return $.post(o,t,function(t){if(t>0)return $("#txt-name-bh").val(""),$("#txt-phone-bh").val(""),$("#txt-yc-bh").val(""),$("#txt-nd-bh").val(""),$("#modal-lien-he").modal("hide"),$("#modal-xn").modal("show"),!1}),!1},SelectLanguage:function(t){var o={culture:t};$.post("Home/SetLanguage",o,function(t){window.location.hostname;window.location.href="/"})},LoadDropdownCart:function(){var t={product_ids:$("#link-target-cart").data("product_ids")};$.post(R.Menu.culture+"/Order/LoadDropdonwCart",t,function(t){var o=$.fn.html;$.fn.html=function(t,n){var a=o.apply(this,arguments);return"function"==typeof n&&n(),a},$("._binding_dropdown_cart").html("").html(t);var n=JSON.parse(localStorage.getItem("arrProduct")),a=[];n.forEach(function(t){var o=t.product_id;a.push(o);var n="#item-dropdown-cart"+o;$(n).find(".small-cart-quantity").text(t.quantity)});var e=n.length,r=0;$(".dropdown-cart").find(".item-cart").each(function(t){r++});var i=e-r;e>0&&($(".small-total-cart").parent().show(),$(".dropdown-quantity-cart").parent().show(),$(".dropdown-quantity-cart").text(i),$(".dropdown-cart").toggle()),R.Menu.DropdownOrderDetailInLocalStorage(),R.Menu.RegisterEvent()})},LoadDropdownCartMoblie:function(){var t={product_ids:$("#link-target-cart-mobile").data("product_ids")};$.post(R.Menu.culture+"/Order/LoadDropdonwCart",t,function(t){var o=$.fn.html;$.fn.html=function(t,n){var a=o.apply(this,arguments);return"function"==typeof n&&n(),a},$("._binding_dropdown_cart").html("").html(t);var n=JSON.parse(localStorage.getItem("arrProduct")),a=[];n.forEach(function(t){var o=t.product_id;a.push(o);var n="#item-dropdown-cart"+o;$(n).find(".small-cart-quantity").text(t.quantity)});var e=n.length,r=0;$(".dropdown-cart-mobile").find(".item-cart").each(function(t){r++});var i=e-r;e>0&&($(".small-total-cart").parent().show(),$(".dropdown-quantity-cart").parent().show(),$(".dropdown-quantity-cart").text(i),$(".dropdown-cart-mobile").toggle()),R.Menu.DropdownOrderDetailInLocalStorage(),R.Menu.RegisterEvent()})},DropdownOrderDetailInLocalStorage:function(){var t={product_ids:$("#link-target-cart").data("product_ids").toString()},o=R.Menu.culture+"/Order/LoadOrderDetailJson";$.post(o,t,function(t){var o=JSON.parse(localStorage.getItem("arrProduct"));t.forEach(function(t){o.find(function(o){o.product_id==t.productId&&(t.flashSaleId>0?o.price=t.productPriceInFlashSale:o.price=t.salePrice)})});var n=0;o.forEach(function(t){n+=t.price*parseInt(t.quantity)}),$(".small-total-cart").html(R.FormatNumber(n)+"đ"),R.Order.RegisterEvent()})},LoadLastSeenProduct:function(){var t=JSON.parse(localStorage.getItem("lastSeen")).slice(0,6),o="";if(null!=t){var n={product_ids:o=t.slice(0,6).toString()};$.post(R.Menu.culture+"/Product/VLastSeen",n,function(t){$("._binding_last_seen_product").html("").html(t),R.Extra.BindingExtraToProduct(),$(".menu-fix .spvx").toggleClass("show")})}},FirstLoadLocation:function(){if("1"==sessionStorage.getItem("locationFirstLoad")){$(".only-first-load-location").css("display","inline");sessionStorage.setItem("locationFirstLoad","0")}}},$(function(){R.Menu.Init()});